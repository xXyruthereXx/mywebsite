<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fullscreen Time Tool</title>
  <style>
    :root{
      --bg: #000000;
      --panel: rgba(255,255,255,0.04);
      --text: #ffffff;
      --muted: #9aa0a6;
      --accent: #6ee7ff;
      --btn-bg: rgba(255,255,255,0.06);
      --btn-hover: rgba(255,255,255,0.12);
      --ring: rgba(110,231,255,0.4);
      --radius: 18px;
      --shadow: 0 20px 40px rgba(0,0,0,0.5);
    }
    /* High-contrast mode */
    .contrast {
      --panel: rgba(255,255,255,0.12);
      --muted: #cfd2d6;
      --accent: #00e1ff;
      --btn-bg: rgba(255,255,255,0.16);
      --btn-hover: rgba(255,255,255,0.28);
      --ring: rgba(0,225,255,0.7);
      letter-spacing: 0.15px;
      text-shadow: 0 0 1px rgba(255,255,255,0.2);
    }

    html, body { height: 100%; }
    body{
      margin:0;
      background: var(--bg);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      display:grid;
      grid-template-rows: auto 1fr;
    }

    /* Top utility bar */
    .topbar{
      position:fixed; inset: 0 0 auto 0;
      padding: 14px clamp(14px, 2vw, 28px);
      display:flex; align-items:center; gap:10px;
      pointer-events: none; /* let center remain easily selectable */
    }
    .topbar > *{ pointer-events: auto; }

    .btn{
      appearance: none; border:0; cursor:pointer;
      background: var(--btn-bg); color: var(--text);
      padding: 10px 14px; border-radius: var(--radius);
      backdrop-filter: blur(8px);
      box-shadow: 0 1px 0 rgba(255,255,255,0.05) inset, 0 8px 24px rgba(0,0,0,0.35);
      transition: transform .12s ease, background .15s ease, box-shadow .15s ease;
      font-weight: 600; font-size: 14px;
    }
    .btn:hover{ background: var(--btn-hover); transform: translateY(-1px); }
    .btn:focus{ outline: 2px solid var(--ring); outline-offset: 2px; }

    /* Right side: timezone */
    .tz{
      margin-left: auto;
      color: var(--muted);
      font-weight: 600; font-size: 14px;
      background: var(--panel);
      padding: 8px 12px; border-radius: 12px;
      box-shadow: var(--shadow);
    }

    /* Center clock */
    .stage{
      min-height: 100vh;
      display:grid; place-items: center;
      padding: clamp(16px, 3vw, 32px);
    }
    .card{
      text-align:center; max-width: 920px; width: min(92vw, 920px);
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: calc(var(--radius) + 8px);
      padding: clamp(24px, 5vw, 48px);
      box-shadow: 0 0 0 1px rgba(255,255,255,0.02) inset, var(--shadow);
    }
    .title{
      color: var(--muted);
      text-transform: none; letter-spacing: .04em;
      font-weight: 700; font-size: clamp(12px, 1.4vw, 14px);
      margin-bottom: clamp(8px, 1.4vw, 12px);
    }
    .time{
      font-variant-numeric: tabular-nums;
      font-size: clamp(44px, 12vw, 140px);
      font-weight: 800; line-height: 1.0;
    }
    .ampm{ font-size: .35em; color: var(--accent); vertical-align: super; margin-left: .2em; }

    .subline{
      margin-top: clamp(10px, 1.6vw, 16px);
      color: var(--muted);
      font-weight: 600;
      font-size: clamp(14px, 3.2vw, 22px);
      display: inline-flex; gap: .5em; align-items: baseline;
      background: var(--panel);
      padding: .5em .8em; border-radius: 12px;
    }
    .dot{ opacity:.6; }

    /* Slide-in modal for menu */
    .overlay{ position: fixed; inset:0; display:none; place-items:center; background: rgba(0,0,0,0.55); }
    .overlay.open{ display: grid; }
    .modal{
      width: min(92vw, 640px);
      background: #0b0b0c;
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: calc(var(--radius) + 6px);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modal-header{
      display:flex; align-items:center; gap:12px;
      padding: 16px 18px; background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }
    .modal-title{ font-weight:800; letter-spacing:.02em; }
    .spacer{ flex:1; }

    .modal-body{ padding: 18px; display:grid; gap:14px; }

    .list{ display:grid; gap:10px; }
    .item{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      padding: 12px 14px; background: var(--panel); border-radius: 14px;
    }
    .item p{ margin:0; color:var(--muted); }

    .pill{
      display:inline-flex; align-items:center; gap:8px; font-weight:700; font-size:13px;
      padding: 10px 12px; border-radius: 999px; background: var(--btn-bg);
    }

    /* Warning dialog */
    .warn {
      width: min(92vw, 560px);
      background: #0b0b0c; color: var(--text);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: calc(var(--radius) + 6px);
      box-shadow: var(--shadow);
      padding: 18px;
      display:none;
    }
    .warn.open{ display:block; }
    .warn h3{ color:#ffb84d; margin: 0 0 8px 0; font-size: 18px; letter-spacing:.02em; }
    .warn p{ margin:0 0 12px 0; color: var(--muted); }
    .warn .row{ display:flex; gap:10px; justify-content:flex-end; }

    .result{
      display:none; padding: 12px 14px; border-radius: 12px; background: rgba(110,231,255,0.08);
      border: 1px solid rgba(110,231,255,0.3);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      word-break: break-word;
    }
    .result.show{ display:block; }

    /* Utility: visually hidden but accessible */
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
  </style>
</head>
<body>
  <!-- Utility buttons and timezone display -->
  <div class="topbar" aria-label="Toolbar">
    <button id="contrastBtn" class="btn" aria-pressed="false" aria-label="Toggle high contrast">High Contrast</button>
    <button id="menuBtn" class="btn" aria-haspopup="dialog" aria-controls="menuOverlay" aria-expanded="false">Menu</button>
    <div id="tz" class="tz" aria-live="polite" title="Detected time zone"></div>
  </div>

  <!-- Main content -->
  <main class="stage">
    <section class="card" aria-live="polite">
      <div class="title">Fullscreen time tool</div>
      <div class="time" id="time">
        --:--<span class="ampm" id="ampm">AM</span>
      </div>
      <div class="subline" id="dateLine">
        <span id="month">Month</span>
        <span class="dot">•</span>
        <span id="daynum">00</span>
        <span class="dot">—</span>
        <span id="weekday">Weekday</span>
      </div>
    </section>
  </main>

  <!-- Menu Overlay -->
  <div class="overlay" id="menuOverlay" role="dialog" aria-modal="true" aria-labelledby="menuTitle">
    <div class="modal" role="document">
      <div class="modal-header">
        <div id="menuTitle" class="modal-title">Tools</div>
        <div class="spacer"></div>
        <button id="closeMenu" class="btn" aria-label="Close menu">Exit</button>
      </div>
      <div class="modal-body">
        <div class="list">
          <div class="item">
            <div>
              <strong>Reveal Public IP</strong>
              <p>Shows your current public IP address<span id="countryHint"> and country</span>.</p>
            </div>
            <button id="revealBtn" class="btn">Reveal</button>
          </div>
        </div>
        <div id="result" class="result" aria-live="polite"></div>
      </div>
    </div>
  </div>

  <!-- Warning dialog (separate so we can animate independently) -->
  <div class="overlay" id="warnOverlay" role="dialog" aria-modal="true" aria-labelledby="warnTitle">
    <div class="warn" role="document">
      <h3 id="warnTitle">⚠️ WARNING</h3>
      <p id="warnText">Beyond this menu lies your public IP address and country.</p>
      <div class="row">
        <button id="warnCancel" class="btn" aria-label="Exit without revealing">Exit</button>
        <button id="warnConfirm" class="btn" aria-label="Continue and reveal">Continue</button>
      </div>
    </div>
  </div>

  <script>
    // ===== Utilities
    const $ = (s, el=document) => el.querySelector(s);

    // Time + Date rendering
    function pad2(n){ return String(n).padStart(2,'0'); }
    function updateClock(){
      const now = new Date();
      let hours = now.getHours();
      const minutes = pad2(now.getMinutes());
      const seconds = pad2(now.getSeconds());
      const am = hours < 12;
      const ampmEl = $('#ampm');
      ampmEl.textContent = am ? 'AM' : 'PM';
      hours = hours % 12 || 12; // 12-hour clock
      $('#time').firstChild.nodeValue = `${hours}:${minutes}:${seconds}`; // keep AM/PM span intact

      const monthName = now.toLocaleString(undefined, { month: 'long' });
      const dayNum = now.getDate();
      const weekday = now.toLocaleString(undefined, { weekday: 'long' });
      $('#month').textContent = monthName;
      $('#daynum').textContent = dayNum;
      $('#weekday').textContent = weekday;
    }

    // Timezone display
    function formatTZ(){
      const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
      const offMin = new Date().getTimezoneOffset(); // minutes behind UTC
      const sign = offMin <= 0 ? '+' : '-';
      const abs = Math.abs(offMin);
      const hh = String(Math.floor(abs/60)).padStart(2,'0');
      const mm = String(abs%60).padStart(2,'0');
      $('#tz').textContent = `${tz} (UTC${sign}${hh}:${mm})`;
    }

    // Accessible focus trapping for modals
    function trapFocus(container){
      const FOCUSABLE = 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex="-1"])';
      const nodes = container.querySelectorAll(FOCUSABLE);
      if(!nodes.length) return;
      const first = nodes[0], last = nodes[nodes.length-1];
      function loop(e){
        if(e.key !== 'Tab') return;
        if(e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); }
        else if(!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); }
      }
      container.addEventListener('keydown', loop);
      return () => container.removeEventListener('keydown', loop);
    }

    // Menu logic
    const contrastBtn = $('#contrastBtn');
    const menuBtn = $('#menuBtn');
    const menuOverlay = $('#menuOverlay');
    const closeMenu = $('#closeMenu');
    const revealBtn = $('#revealBtn');
    const resultBox = $('#result');
    const warnOverlay = $('#warnOverlay');
    const warnConfirm = $('#warnConfirm');
    const warnCancel = $('#warnCancel');
    const warnText = $('#warnText');
    const countryHint = $('#countryHint');

    let untrapMenu = null;

    contrastBtn.addEventListener('click', () => {
      document.body.classList.toggle('contrast');
      const on = document.body.classList.contains('contrast');
      contrastBtn.setAttribute('aria-pressed', on ? 'true' : 'false');
    });

    function openMenu(){
      menuOverlay.classList.add('open');
      menuBtn.setAttribute('aria-expanded', 'true');
      untrapMenu = trapFocus(menuOverlay);
      setTimeout(() => $('#closeMenu').focus(), 0);
    }
    function closeMenuFn(){
      menuOverlay.classList.remove('open');
      menuBtn.setAttribute('aria-expanded', 'false');
      if (typeof untrapMenu === 'function') untrapMenu();
      menuBtn.focus();
    }
    menuBtn.addEventListener('click', openMenu);
    closeMenu.addEventListener('click', closeMenuFn);
    menuOverlay.addEventListener('click', (e)=>{ if(e.target === menuOverlay) closeMenuFn(); });

    // Warning dialog
    function openWarn(){ warnOverlay.classList.add('open'); setTimeout(()=> warnConfirm.focus(), 0); }
    function closeWarn(){ warnOverlay.classList.remove('open'); }

    // Reveal Public IP flow
    revealBtn.addEventListener('click', () => {
      resultBox.classList.remove('show');
      resultBox.textContent = '';
      // Set warning text based on capability
      warnText.textContent = 'Beyond this menu lies your public IP address and country.';
      countryHint.style.display = '';
      openWarn();
    });

    warnCancel.addEventListener('click', () => { closeWarn(); });

    warnConfirm.addEventListener('click', async () => {
      closeWarn();
      resultBox.classList.add('show');
      resultBox.textContent = 'Fetching…';
      try{
        // Try ipapi.co for IP + country
        const res = await fetch('https://ipapi.co/json/');
        if (!res.ok) throw new Error('Request failed');
        const data = await res.json();
        const ip = data.ip || 'Unknown';
        const country = data.country_name || '';
        if(country){
          resultBox.innerHTML = `<strong>Public IP:</strong> ${ip}<br><strong>Country:</strong> ${country}`;
        } else {
          // If no country returned, remove country mention
          countryHint.style.display = 'none';
          resultBox.innerHTML = `<strong>Public IP:</strong> ${ip}`;
        }
      } catch(err){
        // Fallback to ipify (IP only)
        try{
          const r = await fetch('https://api.ipify.org?format=json');
          const j = await r.json();
          countryHint.style.display = 'none';
          resultBox.innerHTML = `<strong>Public IP:</strong> ${j.ip}`;
        } catch(e){
          countryHint.style.display = 'none';
          resultBox.textContent = 'Could not retrieve IP info. Please check your connection or try again later.';
        }
      }
    });

    // Init
    updateClock();
    formatTZ();
    setInterval(updateClock, 1000);
    // Update TZ display on visibility change (covers DST changes or time zone moves)
    document.addEventListener('visibilitychange', () => { if(!document.hidden) formatTZ(); });
  </script>
</body>
</html>
